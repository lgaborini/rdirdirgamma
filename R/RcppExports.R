# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Generate one sample from a Dirichlet distribution.
#'
#' @param alpha the Dirichlet hyperparameter
#' @param seed the RNG seed: if 0 (default), generate a time-based seed
#' @return a numeric vector
#' @export
rdirichlet_cpp <- function(alpha, seed = 0L) {
    .Call('_rdirdirgamma_rdirichlet_cpp', PACKAGE = 'rdirdirgamma', alpha, seed)
}

#' Generate from a Dirichlet distribution using the stick breaking definition (safer).
#'
#' @param n how many samples to generate
#' @param alpha the Dirichlet hyperparameter, with p entries
#' @return a numeric matrix, n*p
#' @export
rdirichlet_beta_cpp <- function(n, alpha) {
    .Call('_rdirdirgamma_rdirichlet_beta_cpp', PACKAGE = 'rdirdirgamma', n, alpha)
}

#' Generate a Dirichlet-Dirichlet-Gamma population (unsafe).
#'
#' Generate samples from m sources and p parameters, n sample per source.
#' The between-source alpha hyperparameter used to generate the source parameters is mandatory.
#'
#' @param n number of samples per source
#' @param m number of sources
#' @param alpha_0 between-source Gamma hyperparameter, a scalar
#' @param beta_0 between-source Gamma hyperparameter, a scalar
#' @param nu_0 between-source Dirichlet hyperparameter, a numeric vector
#' @export
#' @inheritParams rdirichlet_cpp
rdirdirgamma_cpp <- function(n, m, alpha_0, beta_0, nu_0, seed = 0L) {
    .Call('_rdirdirgamma_rdirdirgamma_cpp', PACKAGE = 'rdirdirgamma', n, m, alpha_0, beta_0, nu_0, seed)
}

#' Generate a Dirichlet-Dirichlet-Gamma population (safer).
#'
#' Generate samples from m sources and p parameters, n sample per source.
#' The between-source alpha hyperparameter used to generate the source parameters is mandatory.
#'
#' @export
#' @inheritParams rdirdirgamma_cpp
rdirdirgamma_beta_cpp <- function(n, m, alpha_0, beta_0, nu_0) {
    .Call('_rdirdirgamma_rdirdirgamma_beta_cpp', PACKAGE = 'rdirdirgamma', n, m, alpha_0, beta_0, nu_0)
}

#' Compute column-wise sd
#'
#' @param mtx a nxp matrix
#' @return a 1xp vector
colsd <- function(mtx) {
    .Call('_rdirdirgamma_colsd', PACKAGE = 'rdirdirgamma', mtx)
}

#' Compute the Minkowski norm of a vector
#'
#' Compute the Minkowski norm of a vector.
#' $p$ can range from 1 to infinity.
#'
#' @param v a vector
#' @param p exponent of the Minkowski norm (from 1 to Inf)
#' @return a double
norm_minkowski <- function(v, p = 2) {
    .Call('_rdirdirgamma_norm_minkowski', PACKAGE = 'rdirdirgamma', v, p)
}

#' Perform ABC sampling and distance calculation.
#'
#' Samples from Dirichlet using [rdirdirgamma_cpp()].
#'
#' Summary statistics between datasets:
#'
#' - mean
#' - standard deviation
#'
#' @param mtx_obs the observed data matrix
#' @param reps repetitions to average distances (default: 1)
#' @param n_sample number of samples per source
#' @param m_sample number of sources
#' @param p_norm exponent of the L^p norm (can be `Inf`) (default: 2)
#' @return a reps*2 matrix of distances between summary statistics
#' @export
#' @inheritParams rdirdirgamma_cpp
sample_ABC_rdirdirgamma_cpp <- function(n_sample, m_sample, alpha_0, beta_0, nu_0, mtx_obs, reps, p_norm = 2, seed = 0L) {
    .Call('_rdirdirgamma_sample_ABC_rdirdirgamma_cpp', PACKAGE = 'rdirdirgamma', n_sample, m_sample, alpha_0, beta_0, nu_0, mtx_obs, reps, p_norm, seed)
}

#' Perform ABC sampling and distance calculation using the stick breaking procedure.
#'
#' Samples from Dirichlet using [rdirdirgamma_beta_cpp()].
#'
#' Summary statistics between datasets:
#'
#' - mean
#' - standard deviation
#'
#' @param n_sample passed to [rdirdirgamma_beta_cpp()]
#' @param m_sample passed to [rdirdirgamma_beta_cpp()]
#' @export
#' @return a reps*2 matrix of distances between summary statistics
#' @inheritParams sample_ABC_rdirdirgamma_cpp
sample_ABC_rdirdirgamma_beta_cpp <- function(n_sample, m_sample, alpha_0, beta_0, nu_0, mtx_obs, reps, p_norm = 2) {
    .Call('_rdirdirgamma_sample_ABC_rdirdirgamma_beta_cpp', PACKAGE = 'rdirdirgamma', n_sample, m_sample, alpha_0, beta_0, nu_0, mtx_obs, reps, p_norm)
}

